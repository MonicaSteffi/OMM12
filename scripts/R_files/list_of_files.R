# -------------------------------------------------------------------------
##--- 1. Download files from genbank and refseq: --------------------------
# -------------------------------------------------------------------------
#### NCBI_sequences_download.txt
###### Refseq files were downloaded manually from ftp server.

# -------------------------------------------------------------------------
##--- 2. Edit the gff files from genbank and refseq files: ----------------
# -------------------------------------------------------------------------
#### ________________________________________________________________________________________________________________________________________________
#### ++++++++++++++++++++++++++++++++++++++++++ file name: Genbank_RefSeq_gff_integrate.R +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
#### ________________________________________________________________________________________________________________________________________________

# -------------------------------------------------------------------------
##--- 3. integrate the proteins from genbank and refseq: ------------------
# -------------------------------------------------------------------------
#### ________________________________________________________________________________________________________________________________________________
#### +++++++++++++++++++++++++++++++++ file name: Genbank_RefSeq_proteins_integrate_based_on_coordinates.R +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
#### ________________________________________________________________________________________________________________________________________________

# -----------------------------------------------------------------------------------------
##--- 4. Start annotating using the genome and integrated proteins wherever required. -----
# -----------------------------------------------------------------------------------------
## 4.1. KOFAMSCAN: These integrated proteins are uploaded to /dss/dssfs02/lwp-dss-0001/u7b03/u7b03-dss-0000/ra72seh/DB/Marbouty_annotations_proteins_integrated/ and performed kofamscan analysis. (https://www.genome.jp/tools/kofamkoala/)
## 4.2. dbCAN2 analysis: The genomes are uploaded to the dbCAN2 server.(https://bcb.unl.edu/dbCAN2/blast.php)
## 4.3. OperonMapper: Uploaded the genome to OperonMapper online. (https://biocomputo.ibt.unam.mx/operon_mapper/)
## 4.4. eggNOG: Uploaded the genome to eggNOG online.  (http://eggnog-mapper.embl.de/) 
## 4.5. PULPy:  Took script from https://github.com/WatsonLab/PULpy/tree/master/scripts/predict_puls.R and edited slightly.
#### ________________________________________________________________________________________________________________________________________________
#### ++++++++++++++++++++ file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/joint_Marbouty_PULpy.R ++++++++++++++++++++++
#### ________________________________________________________________________________________________________________________________________________

# -----------------------------------------------------------------------------------------
##--- 5. Clean/modifiy the output files from the tools,ready for integration --------------
##### 5 results: dbCAN2, eggNOG,gff,kofamscan,OperonMapper should be cleaned --------------
# -----------------------------------------------------------------------------------------

# +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
## 5.1. Clean the kofamscan results.
#### ________________________________________________________________________________________________________________________________________________
#### ++++++++++++++++++++ file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/joint_Marbouty_kofam.R ++++++++++++++++++++++
#### ________________________________________________________________________________________________________________________________________________

# +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
## 5.2. Clean the gff files.
#### ________________________________________________________________________________________________________________________________________________
#### ++++++++++++++++++++ file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/joint_Marbouty_operons_gff.R ++++++++++++++++
#### ________________________________________________________________________________________________________________________________________________

# +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
## 5.3. Clean the operon files.
#### ________________________________________________________________________________________________________________________________________________
#### ++++++++++++++++++++ file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/joint_Marbouty_operons_gff.R ++++++++++++++++
#### ________________________________________________________________________________________________________________________________________________


# +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
## 5.4. Clean the dbCAN2 files.
#### ________________________________________________________________________________________________________________________________________________
#### ++++++++++++++++++++ wrapper file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/joint_Marbouty_CGC_ann.R ++++++++++++
#### ++++++++++++++++++++ file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/joint_Marbouty_dbCANSht.R +++++++++++++++++++
#### ________________________________________________________________________________________________________________________________________________

# +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
## 5.5. Clean the eggNOG files.
#### ________________________________________________________________________________________________________________________________________________
#### ++++++++++++++++++++ eggNOGDB--> file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/joint_Marbouty_eggNOGFam.R ++++++
#### ++++++++++++++++++++ NovelFamDB-->file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/joint_Marbouty_NovelFam.R ++++++
#### ________________________________________________________________________________________________________________________________________________

# -----------------------------------------------------------------------------------------
## -------------- 6. Clean annotations from Shetty et al -------------------
# -----------------------------------------------------------------------------------------
#### ________________________________________________________________________________________________________________________________________________
#### ++++++++++++++++++++ -->file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/Shetty_Gene_Cluster.R ++++++++++++++++++++ 
#### ________________________________________________________________________________________________________________________________________________



# -----------------------------------------------------------------------------------------
## -------------- 7. integrate  the cleaned output files from the tools -------------------
# -----------------------------------------------------------------------------------------
#### ________________________________________________________________________________________________________________________________________________
#### ++++++++++++++++++++ -->file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/joint_Marbouty_AllAnnotations_integrate.R 
#### ________________________________________________________________________________________________________________________________________________

# -----------------------------------------------------------------------------------------
## -------------- 8. Identify COG and KOFAMSCAN annotation to OperonMapper output ---------
# -----------------------------------------------------------------------------------------
## 8.1 First add "GenomeNames" to the protein-IDs for each genome protein fasta in operonMapper output.
#### ________________________________________________________________________________________________________________________________________________
#### ++++++++++++++++++++ -->file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/operonMapper_proteins_integrate.R ++++++
#### ________________________________________________________________________________________________________________________________________________

## 8.2 Upload this to kofamscan and eggnog (for eggNOG5 and novelfam databases separately)


# -----------------------------------------------------------------------------------------
## -------------- 9. Create gff file ---------
# -----------------------------------------------------------------------------------------
## Create gff files: One for RNA-seq count, other for genious

#### ________________________________________________________________________________________________________________________________________________
#### ++++++++++++++++++++ -->file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/exc2gffv2_sht.R ++++++
#### ________________________________________________________________________________________________________________________________________________



# -----------------------------------------------------------------------------------------
## -------------- 10. Add KEGG categories, substrate information from KEGG, QuickGO -------
# -----------------------------------------------------------------------------------------
## 10.1 Obtain KEGG category informations like BRITE, MODuLE, reactions for KOs from all the KOFAMKOALA results.

#### ________________________________________________________________________________________________________________________________________________
#### ++++++++++++++++++++ -->file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/joint_Marbouty_KEGGDB.R ++++++
#### ________________________________________________________________________________________________________________________________________________


## 10.2 Obtain chebi (substrate) information based on GO-db IDs obtained from eggNOG database.

#### ________________________________________________________________________________________________________________________________________________
#### ++++++++++++++++++++ -->file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/joint_Marbouty_chebi.R ++++++
#### ________________________________________________________________________________________________________________________________________________





## 10.3 Clean output from  joint_Marbouty_AllAnnotations_integrate.R (_newFinMat.*.rds)
#####  Join output from ## 10.1 (joint_Marbouty_chebi.R), ## 10.2 (joint_Marbouty_KEGGDB.R) to the final annotations:
#### ________________________________________________________________________________________________________________________________________________
#### ++++++++++++++++++++ -->file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/joint_Marbouty_AllAnnotations_integrate_withKEGGCompound_goCHEBI.R ++++++
#### ________________________________________________________________________________________________________________________________________________


## 10.4 Genious-compatible gff file
#### ________________________________________________________________________________________________________________________________________________
#### ++++++++++++++++++++ -->file name: S:/Abilash/Marbouty_annotation_refseq_genbank_2022/scripts/R_files/genious_gff_create.R ++++++
#### ________________________________________________________________________________________________________________________________________________




save.image("H:/OligoMM_annotationFinal.RData")
# load("H:/OligoMM_annotation.RData")
